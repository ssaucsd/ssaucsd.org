---
import { ChevronRight, Home } from "lucide-react";
import { cn } from "@/lib/utils";
import { generateBreadcrumbSchema, type BreadcrumbItem } from "@/lib/schemas";

interface Props {
  items: BreadcrumbItem[];
  className?: string;
}

const { items, className } = Astro.props;

// Always prepend Home
const allItems: BreadcrumbItem[] = [{ name: "Home", href: "/" }, ...items];
---

<!-- JSON-LD Schema -->
<script type="application/ld+json" set:html={JSON.stringify(generateBreadcrumbSchema(allItems))} />

<!-- Visual breadcrumb -->
<nav
  aria-label="Breadcrumb"
  class={cn(
    "flex items-center gap-1.5 text-sm text-muted-foreground",
    className
  )}
>
  <ol class="flex items-center gap-1.5">
    {allItems.map((item, index) => {
      const isLast = index === allItems.length - 1;

      return (
        <li class="flex items-center gap-1.5">
          {index > 0 && (
            <ChevronRight className="h-3.5 w-3.5 flex-shrink-0" />
          )}
          {isLast ? (
            <span
              class="font-medium text-foreground"
              aria-current="page"
            >
              {index === 0 ? <Home className="h-4 w-4" /> : item.name}
            </span>
          ) : (
            <a
              href={item.href!}
              class="hover:text-foreground transition-colors"
            >
              {index === 0 ? <Home className="h-4 w-4" /> : item.name}
            </a>
          )}
        </li>
      );
    })}
  </ol>
</nav>
